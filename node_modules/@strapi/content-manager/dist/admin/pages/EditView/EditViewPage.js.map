{"version":3,"file":"EditViewPage.js","sources":["../../../../admin/src/pages/EditView/EditViewPage.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {\n  Page,\n  Form,\n  useRBAC,\n  useNotification,\n  useQueryParams,\n  tours,\n  Layouts,\n  useIsDesktop,\n  useIsMobile,\n} from '@strapi/admin/strapi-admin';\nimport { Grid, Tabs, Box } from '@strapi/design-system';\nimport { useIntl } from 'react-intl';\nimport { useLocation, useParams } from 'react-router-dom';\nimport { styled } from 'styled-components';\n\nimport { ActionsDrawer } from '../../components/ActionsDrawer';\nimport { SINGLE_TYPES } from '../../constants/collections';\nimport { PERMISSIONS } from '../../constants/plugin';\nimport { DocumentRBAC, useDocumentRBAC } from '../../features/DocumentRBAC';\nimport { useDoc, type UseDocument } from '../../hooks/useDocument';\nimport { useDocumentLayout } from '../../hooks/useDocumentLayout';\nimport { useLazyComponents } from '../../hooks/useLazyComponents';\nimport { useOnce } from '../../hooks/useOnce';\nimport { usePersistentPartialQueryParams } from '../../hooks/usePersistentQueryParams';\nimport { getTranslation } from '../../utils/translations';\nimport { createYupSchema } from '../../utils/validation';\n\nimport { Blocker } from './components/Blocker';\nimport { FormLayout } from './components/FormLayout';\nimport { Header } from './components/Header';\nimport { Panels, PanelsProvider, usePanelsContext, ActionsPanelContent } from './components/Panels';\nimport { handleInvisibleAttributes } from './utils/data';\n\n/* -------------------------------------------------------------------------------------------------\n * EditViewPage\n * -----------------------------------------------------------------------------------------------*/\n\nconst EditViewPage = () => {\n  const location = useLocation();\n  const [\n    {\n      query: { status },\n    },\n    setQuery,\n  ] = useQueryParams<{ status: 'draft' | 'published' }>({\n    status: 'draft',\n  });\n  const { formatMessage } = useIntl();\n  const { toggleNotification } = useNotification();\n  const isDesktop = useIsDesktop();\n  const isMobile = useIsMobile();\n  const visiblePanels = usePanelsContext('Panels', (s) => s.visiblePanels);\n  const drawerHasContent = visiblePanels.length > 0;\n\n  usePersistentPartialQueryParams('STRAPI_LOCALE', ['plugins.i18n.locale'], false);\n\n  const doc = useDoc();\n  const {\n    document,\n    meta,\n    isLoading: isLoadingDocument,\n    schema,\n    components,\n    collectionType,\n    id,\n    model,\n    hasError,\n    getTitle,\n    getInitialFormValues,\n  } = doc;\n\n  const hasDraftAndPublished = schema?.options?.draftAndPublish ?? false;\n\n  useOnce(() => {\n    /**\n     * We only ever want to fire the notification once otherwise\n     * whenever the app re-renders it'll pop up regardless of\n     * what we do because the state comes from react-router-dom\n     */\n    if (location?.state && 'error' in location.state) {\n      toggleNotification({\n        type: 'danger',\n        message: location.state.error,\n        timeout: 5000,\n      });\n    }\n  });\n\n  const isLoadingActionsRBAC = useDocumentRBAC('EditViewPage', (state) => state.isLoading);\n\n  const isSingleType = collectionType === SINGLE_TYPES;\n\n  /**\n   * single-types don't current have an id, but because they're a singleton\n   * we can simply use the update operation to continuously update the same\n   * document with varying params.\n   */\n  const isCreatingDocument = !id && !isSingleType;\n\n  const {\n    isLoading: isLoadingLayout,\n    edit: {\n      layout,\n      settings: { mainField },\n    },\n  } = useDocumentLayout(model);\n  const pageTitle = getTitle(mainField);\n\n  const { isLazyLoading } = useLazyComponents([]);\n\n  const isLoading = isLoadingActionsRBAC || isLoadingDocument || isLoadingLayout || isLazyLoading;\n\n  const initialValues = getInitialFormValues(isCreatingDocument);\n\n  if (isLoading && !document?.documentId) {\n    return <Page.Loading />;\n  }\n\n  if (!initialValues || hasError) {\n    return <Page.Error />;\n  }\n\n  const handleTabChange = (status: string) => {\n    if (status === 'published' || status === 'draft') {\n      setQuery({ status }, 'push', true);\n    }\n  };\n\n  const validateSync = (values: Record<string, unknown>, options: Record<string, string>) => {\n    const yupSchema = createYupSchema(schema?.attributes, components, {\n      status,\n      ...options,\n    });\n\n    return yupSchema.validateSync(values, { abortEarly: false });\n  };\n\n  return (\n    <Page.Main>\n      <Page.Title>{pageTitle}</Page.Title>\n      {isSingleType && (\n        <tours.contentManager.Introduction>\n          {/* Invisible Anchor */}\n          <Box />\n        </tours.contentManager.Introduction>\n      )}\n      <Form\n        disabled={hasDraftAndPublished && status === 'published'}\n        initialValues={initialValues}\n        method={isCreatingDocument ? 'POST' : 'PUT'}\n        validate={(values: Record<string, unknown>, options: Record<string, string>) => {\n          // removes hidden fields from the validation\n          // this is necessary because the yup schema doesn't know about the visibility conditions\n          // and we don't want to validate fields that are not visible\n          const { data: cleanedValues, removedAttributes } = handleInvisibleAttributes(values, {\n            schema,\n            initialValues,\n            components,\n          });\n\n          const yupSchema = createYupSchema(schema?.attributes, components, {\n            status,\n            removedAttributes,\n            ...options,\n          });\n\n          return yupSchema.validate(cleanedValues, { abortEarly: false });\n        }}\n        initialErrors={location?.state?.forceValidation ? validateSync(initialValues, {}) : {}}\n      >\n        <>\n          <Header\n            isCreating={isCreatingDocument}\n            status={hasDraftAndPublished ? getDocumentStatus(document, meta) : undefined}\n            title={pageTitle}\n          />\n          <Layouts.Content>\n            <Tabs.Root variant=\"simple\" value={status} onValueChange={handleTabChange}>\n              <Tabs.List\n                aria-label={formatMessage({\n                  id: getTranslation('containers.edit.tabs.label'),\n                  defaultMessage: 'Document status',\n                })}\n              >\n                {hasDraftAndPublished ? (\n                  <>\n                    <StatusTab value=\"draft\">\n                      {formatMessage({\n                        id: getTranslation('containers.edit.tabs.draft'),\n                        defaultMessage: 'draft',\n                      })}\n                    </StatusTab>\n                    <StatusTab\n                      disabled={!meta || meta.availableStatus.length === 0}\n                      value=\"published\"\n                    >\n                      {formatMessage({\n                        id: getTranslation('containers.edit.tabs.published'),\n                        defaultMessage: 'published',\n                      })}\n                    </StatusTab>\n                  </>\n                ) : null}\n              </Tabs.List>\n              <Grid.Root\n                paddingTop={{\n                  initial: 6,\n                  medium: 4,\n                  large: 8,\n                }}\n                gap={4}\n              >\n                <Grid.Item col={9} xs={12} direction=\"column\" alignItems=\"stretch\">\n                  <Tabs.Content value=\"draft\">\n                    <tours.contentManager.Fields>\n                      <Box />\n                    </tours.contentManager.Fields>\n                    <FormLayout layout={layout} document={doc} hasBackground={!isMobile} />\n                  </Tabs.Content>\n                  <Tabs.Content value=\"published\">\n                    <FormLayout layout={layout} document={doc} hasBackground={!isMobile} />\n                  </Tabs.Content>\n                </Grid.Item>\n                {isDesktop && (\n                  <Grid.Item col={3} direction=\"column\" alignItems=\"stretch\">\n                    <Panels />\n                  </Grid.Item>\n                )}\n              </Grid.Root>\n            </Tabs.Root>\n            {!isDesktop && (\n              <>\n                <ActionsDrawer.Root hasContent={drawerHasContent} hasSideNav>\n                  <ActionsDrawer.Overlay />\n                  <ActionsDrawer.Header>\n                    <ActionsPanelContent />\n                  </ActionsDrawer.Header>\n                  <ActionsDrawer.Content>\n                    <Panels withActions={false} />\n                  </ActionsDrawer.Content>\n                </ActionsDrawer.Root>\n                {/* Adding a fixed height to the bottom of the page to prevent \n                the actions drawer from covering the content\n                (40px button + 12px * 2 padding + 1px border) */}\n                <Box height=\"6.5rem\" />\n              </>\n            )}\n          </Layouts.Content>\n          <Blocker />\n        </>\n      </Form>\n    </Page.Main>\n  );\n};\n\nconst StatusTab = styled(Tabs.Trigger)`\n  text-transform: uppercase;\n`;\n\n/**\n * @internal\n * @description Returns the status of the document where its latest state takes priority,\n * this typically will be \"published\" unless a user has edited their draft in which we should\n * display \"modified\".\n */\nconst getDocumentStatus = (\n  document: ReturnType<UseDocument>['document'],\n  meta: ReturnType<UseDocument>['meta']\n): 'draft' | 'published' | 'modified' => {\n  const docStatus = document?.status;\n  const statuses = meta?.availableStatus ?? [];\n\n  /**\n   * Creating an entry\n   */\n  if (!docStatus) {\n    return 'draft';\n  }\n\n  /**\n   * We're viewing a draft, but the document could have a published version\n   */\n  if (docStatus === 'draft' && statuses.find((doc) => doc.publishedAt !== null)) {\n    return 'published';\n  }\n\n  return docStatus;\n};\n\n/* -------------------------------------------------------------------------------------------------\n * ProtectedEditViewPage\n * -----------------------------------------------------------------------------------------------*/\n\nconst ProtectedEditViewPage = () => {\n  const { slug = '' } = useParams<{\n    slug: string;\n  }>();\n  const {\n    permissions = [],\n    isLoading,\n    error,\n  } = useRBAC(\n    PERMISSIONS.map((action) => ({\n      action,\n      subject: slug,\n    }))\n  );\n\n  if (isLoading) {\n    return <Page.Loading />;\n  }\n\n  if (error || !slug) {\n    return <Page.Error />;\n  }\n\n  return (\n    <Page.Protect permissions={permissions}>\n      {({ permissions }) => (\n        <DocumentRBAC permissions={permissions}>\n          <PanelsProvider>\n            <EditViewPage />\n          </PanelsProvider>\n        </DocumentRBAC>\n      )}\n    </Page.Protect>\n  );\n};\n\nexport { EditViewPage, ProtectedEditViewPage, getDocumentStatus };\n"],"names":["EditViewPage","location","useLocation","query","status","setQuery","useQueryParams","formatMessage","useIntl","toggleNotification","useNotification","isDesktop","useIsDesktop","isMobile","useIsMobile","visiblePanels","usePanelsContext","s","drawerHasContent","length","usePersistentPartialQueryParams","doc","useDoc","document","meta","isLoading","isLoadingDocument","schema","components","collectionType","id","model","hasError","getTitle","getInitialFormValues","hasDraftAndPublished","options","draftAndPublish","useOnce","state","type","message","error","timeout","isLoadingActionsRBAC","useDocumentRBAC","isSingleType","SINGLE_TYPES","isCreatingDocument","isLoadingLayout","edit","layout","settings","mainField","useDocumentLayout","pageTitle","isLazyLoading","useLazyComponents","initialValues","documentId","_jsx","Page","Loading","Error","handleTabChange","validateSync","values","yupSchema","createYupSchema","attributes","abortEarly","_jsxs","Main","Title","tours","contentManager","Introduction","Box","Form","disabled","method","validate","data","cleanedValues","removedAttributes","handleInvisibleAttributes","initialErrors","forceValidation","_Fragment","Header","isCreating","getDocumentStatus","undefined","title","Layouts","Content","Tabs","Root","variant","value","onValueChange","List","aria-label","getTranslation","defaultMessage","StatusTab","availableStatus","Grid","paddingTop","initial","medium","large","gap","Item","col","xs","direction","alignItems","Fields","FormLayout","hasBackground","Panels","ActionsDrawer","hasContent","hasSideNav","Overlay","ActionsPanelContent","withActions","height","Blocker","styled","Trigger","docStatus","statuses","find","publishedAt","ProtectedEditViewPage","slug","useParams","permissions","useRBAC","PERMISSIONS","map","action","subject","Protect","DocumentRBAC","PanelsProvider"],"mappings":"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"}