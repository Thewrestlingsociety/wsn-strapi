{"version":3,"file":"UploadProgressDialog.js","sources":["../../../../admin/src/future/components/UploadProgressDialog.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport * as Dialog from '@radix-ui/react-dialog';\nimport { Box, Flex, IconButton, TextButton, Typography } from '@strapi/design-system';\nimport {\n  ArrowsCounterClockwise,\n  Check,\n  CheckCircle,\n  ChevronDown,\n  Cross,\n  CrossCircle,\n  MinusCircle,\n  Upload,\n} from '@strapi/icons';\nimport { useIntl } from 'react-intl';\nimport { styled, keyframes } from 'styled-components';\n\nimport { abortUpload, useRetryCancelledFilesStreamMutation } from '../services/api';\nimport { useTypedDispatch, useTypedSelector } from '../store/hooks';\nimport { closeUploadProgress, toggleMinimize, cancelUpload } from '../store/uploadProgress';\nimport { getTranslationKey } from '../utils/translations';\n\nimport type { FileProgress, FileProgressStatus } from '../store/uploadProgress';\n\n/* -------------------------------------------------------------------------------------------------\n * DialogHeader\n * -----------------------------------------------------------------------------------------------*/\n\nconst HeaderStatusMessage = ({ title, subtitle }: { title: string; subtitle?: string }) => {\n  return (\n    <Flex direction=\"column\" alignItems=\"flex-start\" paddingLeft={2}>\n      <Dialog.Title>\n        <Typography variant=\"omega\">{title}</Typography>\n      </Dialog.Title>\n      <Dialog.Description>\n        <Typography variant=\"pi\" textColor=\"neutral600\">\n          {subtitle}\n        </Typography>\n      </Dialog.Description>\n    </Flex>\n  );\n};\n\nconst HeaderStatusIcon = styled(Flex)`\n  padding: ${({ theme }) => theme.spaces[3]};\n  border-radius: ${({ theme }) => `${theme.borderRadius} 0 0 ${theme.borderRadius}`};\n\n  > svg {\n    height: 24px;\n    width: 24px;\n  }\n`;\n\nconst HeaderStatusWrapper = styled(Dialog.Title)`\n  display: flex;\n  align-items: center;\n`;\n\ntype HeaderStatusProps = {\n  status: 'uploading' | 'success' | 'error' | 'canceled';\n  progress?: number;\n  totalFiles: number;\n};\n\nconst HeaderStatus = ({ status, progress, totalFiles }: HeaderStatusProps) => {\n  const { formatMessage } = useIntl();\n\n  if (status === 'error') {\n    return (\n      <HeaderStatusWrapper>\n        <HeaderStatusIcon background=\"danger200\">\n          <Cross fill=\"danger700\" />\n        </HeaderStatusIcon>\n        <HeaderStatusMessage\n          title={formatMessage({\n            id: getTranslationKey('upload.progress.failed'),\n            defaultMessage: 'Upload failed',\n          })}\n          subtitle={formatMessage({\n            id: getTranslationKey('upload.progress.failed.subtitle'),\n            defaultMessage: 'Please try to upload files again',\n          })}\n        />\n      </HeaderStatusWrapper>\n    );\n  }\n\n  if (status === 'success') {\n    return (\n      <HeaderStatusWrapper>\n        <HeaderStatusIcon background=\"success200\">\n          <Check fill=\"success700\" />\n        </HeaderStatusIcon>\n        <HeaderStatusMessage\n          title={formatMessage({\n            id: getTranslationKey('upload.progress.success'),\n            defaultMessage: 'Upload successful!',\n          })}\n          subtitle={formatMessage(\n            {\n              id: getTranslationKey('upload.progress.success.subtitle'),\n              defaultMessage: '{count} files uploaded successfully',\n            },\n            { count: totalFiles }\n          )}\n        />\n      </HeaderStatusWrapper>\n    );\n  }\n\n  if (status === 'canceled') {\n    return (\n      <HeaderStatusWrapper>\n        <HeaderStatusIcon background=\"neutral200\">\n          <MinusCircle fill=\"neutral700\" />\n        </HeaderStatusIcon>\n        <HeaderStatusMessage\n          title={formatMessage({\n            id: getTranslationKey('upload.progress.canceled'),\n            defaultMessage: 'Upload canceled',\n          })}\n          subtitle={formatMessage({\n            id: getTranslationKey('upload.progress.canceled.subtitle'),\n            defaultMessage: 'Some files were not uploaded',\n          })}\n        />\n      </HeaderStatusWrapper>\n    );\n  }\n\n  if (status === 'uploading') {\n    const progressPercentage = progress ? Math.round(progress) : 0;\n\n    return (\n      <HeaderStatusWrapper>\n        <HeaderStatusIcon background=\"primary200\">\n          <Upload fill=\"primary700\" />\n        </HeaderStatusIcon>\n        <HeaderStatusMessage\n          title={formatMessage(\n            {\n              id: getTranslationKey('upload.progress.uploading.withCount'),\n              defaultMessage: 'Uploading {total} items ({percentage}%)',\n            },\n            {\n              total: totalFiles,\n              percentage: progressPercentage,\n            }\n          )}\n        />\n      </HeaderStatusWrapper>\n    );\n  }\n\n  return null;\n};\n\nconst HeaderIconButton = styled(IconButton)`\n  &:hover {\n    background: transparent;\n  }\n`;\n\nconst ChevronWrapper = styled.span<{ $isMinimized: boolean }>`\n  display: flex;\n  transition: transform 0.5s ease-in-out;\n  transform: ${({ $isMinimized }) => ($isMinimized ? 'rotate(180deg)' : 'rotate(0deg)')};\n`;\n\nconst HEADER_COLOR_MAP = {\n  uploading: { background: 'primary100' },\n  canceled: { background: 'neutral100' },\n  success: { background: 'success100' },\n  error: { background: 'danger100' },\n} as const;\n\nconst DialogHeader = ({ handleClose }: { handleClose: () => void }) => {\n  const { formatMessage } = useIntl();\n\n  const { isMinimized, progress, files, uploadId, totalFiles } = useTypedSelector(\n    (state) => state.uploadProgress\n  );\n  const dispatch = useTypedDispatch();\n  const [retryCancelledFiles] = useRetryCancelledFilesStreamMutation();\n\n  const isComplete = progress === 100;\n  const isAllUploaded = isComplete && files.every((f) => f.status !== 'uploading');\n  const isAllErrored = isComplete && files.length > 0 && files.every((f) => f.status === 'error');\n  const hasCancelledFiles = files.some((f) => f.status === 'cancelled');\n  const isSuccess = isComplete && isAllUploaded && !isAllErrored && !hasCancelledFiles;\n  const status = ((): HeaderStatusProps['status'] => {\n    if (isAllErrored) return 'error';\n    if (isSuccess) return 'success';\n    if (hasCancelledFiles) return 'canceled';\n\n    return 'uploading';\n  })();\n\n  const handleCancel = () => {\n    abortUpload(uploadId);\n    dispatch(cancelUpload());\n  };\n\n  const handleRetry = async () => {\n    try {\n      await retryCancelledFiles().unwrap();\n    } catch {\n      // Error is already dispatched to store from the API queryFn\n    }\n  };\n\n  const handleToggleMinimize = () => {\n    dispatch(toggleMinimize());\n  };\n\n  return (\n    <Flex\n      background={HEADER_COLOR_MAP[status].background}\n      justifyContent=\"space-between\"\n      margin={1}\n      hasRadius\n    >\n      <HeaderStatus status={status} progress={progress} totalFiles={totalFiles} />\n      <Flex gap={1}>\n        {!isAllUploaded && (\n          <TextButton onClick={handleCancel} fontWeight=\"bold\">\n            {formatMessage({\n              id: getTranslationKey('upload.progress.cancel'),\n              defaultMessage: 'Cancel',\n            })}\n          </TextButton>\n        )}\n        {hasCancelledFiles && (\n          <TextButton onClick={handleRetry} fontWeight=\"bold\">\n            {formatMessage({\n              id: getTranslationKey('upload.progress.retry'),\n              defaultMessage: 'Retry',\n            })}\n          </TextButton>\n        )}\n        <HeaderIconButton\n          onClick={handleToggleMinimize}\n          label={formatMessage({\n            id: getTranslationKey(\n              isMinimized ? 'upload.progress.maximize' : 'upload.progress.minimize'\n            ),\n            defaultMessage: isMinimized ? 'Maximize' : 'Minimize',\n          })}\n          variant=\"ghost\"\n        >\n          <ChevronWrapper $isMinimized={isMinimized}>\n            <ChevronDown />\n          </ChevronWrapper>\n        </HeaderIconButton>\n        {isComplete && (\n          <HeaderIconButton\n            onClick={handleClose}\n            label={formatMessage({\n              id: getTranslationKey('upload.progress.close'),\n              defaultMessage: 'Close',\n            })}\n            variant=\"ghost\"\n          >\n            <Cross />\n          </HeaderIconButton>\n        )}\n      </Flex>\n    </Flex>\n  );\n};\n\n/* -------------------------------------------------------------------------------------------------\n * UploadProgressDialog\n * -----------------------------------------------------------------------------------------------*/\n\nconst indeterminate = keyframes`\n  0% {\n    transform: translateX(-100%);\n  }\n  100% {\n    transform: translateX(400%);\n  }\n`;\n\nconst IndeterminateBar = styled.div`\n  width: 100%;\n  height: ${({ theme }) => theme.spaces[1]};\n  background-color: ${({ theme }) => theme.colors.neutral200};\n  border-radius: 4px;\n  overflow: hidden;\n  position: relative;\n\n  &::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 25%;\n    background-color: ${({ theme }) => theme.colors.primary700};\n    border-radius: 4px;\n    animation: ${indeterminate} 1.5s ease-in-out infinite;\n  }\n`;\n\nconst FileRow = ({\n  icon,\n  fileName,\n  children,\n}: {\n  icon: React.ReactNode;\n  fileName: string;\n  children: React.ReactNode;\n}) => {\n  return (\n    <Flex direction=\"column\" alignItems=\"stretch\" justifyContent=\"center\" gap={1} width=\"100%\">\n      <Flex gap={2}>\n        {icon}\n        <Typography variant=\"omega\" fontWeight=\"semiBold\" ellipsis>\n          {fileName}\n        </Typography>\n      </Flex>\n      {children}\n    </Flex>\n  );\n};\n\nconst FileRowRenderer = ({ file }: { file: FileProgress }) => {\n  const { formatMessage } = useIntl();\n  const isError = file.status === 'error';\n  const isCurrentFile = file.status === 'uploading';\n  const isCompleted = file.status === 'complete';\n  const isCancelled = file.status === 'cancelled';\n\n  if (isCurrentFile) {\n    return (\n      <FileRow icon={<ArrowsCounterClockwise fill=\"secondary600\" />} fileName={file.name}>\n        <Typography variant=\"pi\" textColor=\"neutral600\">\n          {formatMessage({\n            id: getTranslationKey('upload.progress.file.uploading'),\n            defaultMessage: 'Uploading...',\n          })}\n        </Typography>\n        <IndeterminateBar />\n      </FileRow>\n    );\n  }\n\n  if (isError) {\n    return (\n      <FileRow icon={<CrossCircle fill=\"danger500\" />} fileName={file.name}>\n        <Typography variant=\"pi\" textColor=\"neutral600\">\n          {file.error}\n        </Typography>\n      </FileRow>\n    );\n  }\n\n  if (isCancelled) {\n    return (\n      <FileRow icon={<MinusCircle fill=\"neutral600\" />} fileName={file.name}>\n        <Typography variant=\"pi\" textColor=\"neutral600\">\n          {formatMessage({\n            id: getTranslationKey('upload.progress.file.canceled'),\n            defaultMessage: 'Canceled',\n          })}\n        </Typography>\n      </FileRow>\n    );\n  }\n\n  if (isCompleted) {\n    return (\n      <FileRow icon={<CheckCircle fill=\"success500\" />} fileName={file.name}>\n        <Typography variant=\"pi\" textColor=\"neutral600\">\n          {formatMessage({\n            id: getTranslationKey('upload.progress.file.uploaded'),\n            defaultMessage: 'Uploaded',\n          })}\n        </Typography>\n      </FileRow>\n    );\n  }\n\n  return null;\n};\n\nconst DialogContent = styled(Dialog.Content)`\n  position: fixed;\n  bottom: ${({ theme }) => theme.spaces[4]};\n  right: ${({ theme }) => theme.spaces[4]};\n  width: 400px;\n  background-color: ${({ theme }) => theme.colors.neutral0};\n  border-radius: ${({ theme }) => theme.borderRadius};\n  box-shadow: ${({ theme }) => theme.shadows.popupShadow};\n  z-index: 1000;\n  overflow: hidden;\n  border: 1px solid ${({ theme }) => theme.colors.neutral150};\n\n  &:focus {\n    outline: none;\n  }\n`;\n\nconst CompletedFilesList = styled(Flex)`\n  max-height: 200px;\n  overflow-y: auto;\n  flex-direction: column;\n  gap: ${({ theme }) => theme.spaces[2]};\n  width: 100%;\n`;\n\nconst AnimatedContent = styled.div<{ $isVisible: boolean }>`\n  display: grid;\n  grid-template-rows: ${({ $isVisible }) => ($isVisible ? '1fr' : '0fr')};\n  transition: grid-template-rows 0.3s ease-in-out;\n\n  > div {\n    overflow: hidden;\n  }\n`;\n\nexport const UploadProgressDialog = () => {\n  const dispatch = useTypedDispatch();\n  const { isVisible, isMinimized, files } = useTypedSelector((state) => state.uploadProgress);\n\n  const currentFile = files.find((f) => f.status === 'uploading');\n  const completedFiles = files\n    .filter((f) => f.status === 'complete' || f.status === 'error' || f.status === 'cancelled')\n    .sort((a, b) => {\n      // Sort priority: error > cancelled > complete\n      const priority: Record<FileProgressStatus, number> = {\n        error: 0,\n        cancelled: 1,\n        complete: 2,\n        uploading: 3,\n        pending: 4,\n      };\n      return priority[a.status] - priority[b.status];\n    });\n\n  const handleClose = () => {\n    dispatch(closeUploadProgress());\n  };\n\n  return (\n    <Dialog.Root open={isVisible} modal={false}>\n      <Dialog.Portal>\n        <DialogContent\n          // The accessible name is set by Dialog.Title and is dynamic,\n          // use a data-testid to ensure a stable target for e2e tests\n          data-testid=\"upload-progress-dialog\"\n        >\n          <DialogHeader handleClose={handleClose} />\n\n          <AnimatedContent $isVisible={!isMinimized}>\n            <Box>\n              <Flex\n                direction=\"column\"\n                alignItems=\"stretch\"\n                gap={4}\n                paddingTop={4}\n                paddingBottom={4}\n                paddingLeft={4}\n                paddingRight={4}\n              >\n                {currentFile && <FileRowRenderer file={currentFile} />}\n\n                {completedFiles.length > 0 && (\n                  <CompletedFilesList>\n                    {completedFiles.map((file) => (\n                      <FileRowRenderer key={file.index} file={file} />\n                    ))}\n                  </CompletedFilesList>\n                )}\n              </Flex>\n            </Box>\n          </AnimatedContent>\n        </DialogContent>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n"],"names":["HeaderStatusMessage","title","subtitle","_jsxs","Flex","direction","alignItems","paddingLeft","_jsx","Dialog","Title","Typography","variant","Description","textColor","HeaderStatusIcon","styled","theme","spaces","borderRadius","HeaderStatusWrapper","HeaderStatus","status","progress","totalFiles","formatMessage","useIntl","background","Cross","fill","id","getTranslationKey","defaultMessage","Check","count","MinusCircle","progressPercentage","Math","round","Upload","total","percentage","HeaderIconButton","IconButton","ChevronWrapper","span","$isMinimized","HEADER_COLOR_MAP","uploading","canceled","success","error","DialogHeader","handleClose","isMinimized","files","uploadId","useTypedSelector","state","uploadProgress","dispatch","useTypedDispatch","retryCancelledFiles","useRetryCancelledFilesStreamMutation","isComplete","isAllUploaded","every","f","isAllErrored","length","hasCancelledFiles","some","isSuccess","handleCancel","abortUpload","cancelUpload","handleRetry","unwrap","handleToggleMinimize","toggleMinimize","justifyContent","margin","hasRadius","gap","TextButton","onClick","fontWeight","label","ChevronDown","indeterminate","keyframes","IndeterminateBar","div","colors","neutral200","primary700","FileRow","icon","fileName","children","width","ellipsis","FileRowRenderer","file","isError","isCurrentFile","isCompleted","isCancelled","ArrowsCounterClockwise","name","CrossCircle","CheckCircle","DialogContent","Content","neutral0","shadows","popupShadow","neutral150","CompletedFilesList","AnimatedContent","$isVisible","UploadProgressDialog","isVisible","currentFile","find","completedFiles","filter","sort","a","b","priority","cancelled","complete","pending","closeUploadProgress","Root","open","modal","Portal","data-testid","Box","paddingTop","paddingBottom","paddingRight","map","index"],"mappings":"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"}