{"version":3,"file":"Register.mjs","sources":["../../../../../../../admin/src/pages/Auth/components/Register.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { Box, Button, Flex, Grid, Typography, Link } from '@strapi/design-system';\nimport omit from 'lodash/omit';\nimport { type MessageDescriptor, type PrimitiveType, useIntl } from 'react-intl';\nimport { NavLink, Navigate, useNavigate, useMatch, useLocation } from 'react-router-dom';\nimport { styled } from 'styled-components';\nimport * as yup from 'yup';\nimport { ValidationError } from 'yup';\n\nimport {\n  Register as RegisterUser,\n  RegisterAdmin,\n} from '../../../../../shared/contracts/authentication';\nimport { Form, FormHelpers } from '../../../components/Form';\nimport { InputRenderer } from '../../../components/FormInputs/Renderer';\nimport { useNpsSurveySettings } from '../../../components/NpsSurvey';\nimport { Logo } from '../../../components/UnauthenticatedLogo';\nimport { useTypedDispatch } from '../../../core/store/hooks';\nimport { useNotification } from '../../../features/Notifications';\nimport { useTracking } from '../../../features/Tracking';\nimport { useAPIErrorHandler } from '../../../hooks/useAPIErrorHandler';\nimport { LayoutContent, UnauthenticatedLayout } from '../../../layouts/UnauthenticatedLayout';\nimport { login } from '../../../reducer';\nimport {\n  useGetRegistrationInfoQuery,\n  useRegisterAdminMutation,\n  useRegisterUserMutation,\n} from '../../../services/auth';\nimport { isBaseQueryError } from '../../../utils/baseQuery';\nimport { getOrCreateDeviceId } from '../../../utils/deviceId';\nimport { getByteSize } from '../../../utils/strings';\nimport { translatedErrors } from '../../../utils/translatedErrors';\n\nconst REGISTER_USER_SCHEMA = yup.object().shape({\n  firstname: yup.string().trim().required(translatedErrors.required).nullable(),\n  lastname: yup.string().nullable(),\n  password: yup\n    .string()\n    .min(8, {\n      id: translatedErrors.minLength.id,\n      defaultMessage: 'Password must be at least 8 characters',\n      values: { min: 8 },\n    })\n    .test(\n      'max-bytes',\n      {\n        id: 'components.Input.error.contain.maxBytes',\n        defaultMessage: 'Password must be less than 73 bytes',\n      },\n      function (value) {\n        if (!value || typeof value !== 'string') return true; // validated elsewhere\n\n        const byteSize = getByteSize(value);\n        return byteSize <= 72;\n      }\n    )\n    .test(\n      'lowercase',\n      {\n        message: {\n          id: 'components.Input.error.contain.lowercase',\n          defaultMessage: 'Password must contain at least 1 lowercase letter',\n        },\n      },\n      (value) => {\n        if (!value) return true;\n        return /[a-z]/.test(value);\n      }\n    )\n    .test(\n      'uppercase',\n      {\n        message: {\n          id: 'components.Input.error.contain.uppercase',\n          defaultMessage: 'Password must contain at least 1 uppercase letter',\n        },\n      },\n      (value) => {\n        if (!value) return true;\n        return /[A-Z]/.test(value);\n      }\n    )\n    .test(\n      'number',\n      {\n        message: {\n          id: 'components.Input.error.contain.number',\n          defaultMessage: 'Password must contain at least 1 number',\n        },\n      },\n      (value) => {\n        if (!value) return true;\n        return /\\d/.test(value);\n      }\n    )\n    .required({\n      id: translatedErrors.required.id,\n      defaultMessage: 'Password is required',\n    })\n    .nullable(),\n  confirmPassword: yup\n    .string()\n    .required({\n      id: translatedErrors.required.id,\n      defaultMessage: 'Confirm password is required',\n    })\n    .oneOf([yup.ref('password'), null], {\n      id: 'components.Input.error.password.noMatch',\n      defaultMessage: 'Passwords must match',\n    })\n    .nullable(),\n  registrationToken: yup.string().required({\n    id: translatedErrors.required.id,\n    defaultMessage: 'Registration token is required',\n  }),\n});\n\nconst REGISTER_ADMIN_SCHEMA = yup.object().shape({\n  firstname: yup\n    .string()\n    .trim()\n    .required({\n      id: translatedErrors.required.id,\n      defaultMessage: 'Firstname is required',\n    })\n    .nullable(),\n  lastname: yup.string().nullable(),\n  password: yup\n    .string()\n    .min(8, {\n      id: translatedErrors.minLength.id,\n      defaultMessage: 'Password must be at least 8 characters',\n      values: { min: 8 },\n    })\n    .test(\n      'max-bytes',\n      {\n        id: 'components.Input.error.contain.maxBytes',\n        defaultMessage: 'Password must be less than 73 bytes',\n      },\n      function (value) {\n        if (!value) return true;\n        return new TextEncoder().encode(value).length <= 72;\n      }\n    )\n    .test(\n      'lowercase',\n      {\n        message: {\n          id: 'components.Input.error.contain.lowercase',\n          defaultMessage: 'Password must contain at least 1 lowercase letter',\n        },\n      },\n      (value) => {\n        if (!value) return true;\n        return /[a-z]/.test(value);\n      }\n    )\n    .test(\n      'uppercase',\n      {\n        message: {\n          id: 'components.Input.error.contain.uppercase',\n          defaultMessage: 'Password must contain at least 1 uppercase letter',\n        },\n      },\n      (value) => {\n        if (!value) return true;\n        return /[A-Z]/.test(value);\n      }\n    )\n    .test(\n      'number',\n      {\n        message: {\n          id: 'components.Input.error.contain.number',\n          defaultMessage: 'Password must contain at least 1 number',\n        },\n      },\n      (value) => {\n        if (!value) return true;\n        return /\\d/.test(value);\n      }\n    )\n    .required({\n      id: translatedErrors.required.id,\n      defaultMessage: 'Password is required',\n    })\n    .nullable(),\n  confirmPassword: yup\n    .string()\n    .required({\n      id: translatedErrors.required.id,\n      defaultMessage: 'Confirm password is required',\n    })\n    .nullable()\n    .oneOf([yup.ref('password'), null], {\n      id: 'components.Input.error.password.noMatch',\n      defaultMessage: 'Passwords must match',\n    }),\n  email: yup\n    .string()\n    .email({\n      id: translatedErrors.email.id,\n      defaultMessage: 'Not a valid email',\n    })\n    .strict()\n    .lowercase({\n      id: translatedErrors.lowercase.id,\n      defaultMessage: 'Email must be lowercase',\n    })\n    .required({\n      id: translatedErrors.required.id,\n      defaultMessage: 'Email is required',\n    })\n    .nullable(),\n});\n\ninterface RegisterProps {\n  hasAdmin?: boolean;\n}\n\ninterface RegisterFormValues {\n  firstname: string;\n  lastname: string;\n  email: string;\n  password: string;\n  confirmPassword: string;\n  registrationToken: string | undefined;\n  news: boolean;\n}\n\ninterface IntlFormattedMessage extends MessageDescriptor {\n  values?: Record<string, PrimitiveType>;\n}\n\nconst Register = ({ hasAdmin }: RegisterProps) => {\n  const { toggleNotification } = useNotification();\n  const navigate = useNavigate();\n  const [submitCount, setSubmitCount] = React.useState(0);\n  const [apiError, setApiError] = React.useState<string>();\n  const { trackUsage } = useTracking();\n  const { formatMessage } = useIntl();\n  const { search: searchString } = useLocation();\n  const query = React.useMemo(() => new URLSearchParams(searchString), [searchString]);\n  const match = useMatch('/auth/:authType');\n  const {\n    _unstableFormatAPIError: formatAPIError,\n    _unstableFormatValidationErrors: formatValidationErrors,\n  } = useAPIErrorHandler();\n  const { setNpsSurveySettings } = useNpsSurveySettings();\n\n  const registrationToken = query.get('registrationToken');\n\n  const { data: userInfo, error } = useGetRegistrationInfoQuery(registrationToken as string, {\n    skip: !registrationToken,\n  });\n\n  React.useEffect(() => {\n    if (error) {\n      const message: string = isBaseQueryError(error)\n        ? formatAPIError(error)\n        : (error.message ?? '');\n\n      toggleNotification({\n        type: 'danger',\n        message,\n      });\n\n      navigate(`/auth/oops?info=${encodeURIComponent(message)}`);\n    }\n  }, [error, formatAPIError, navigate, toggleNotification]);\n\n  const [registerAdmin] = useRegisterAdminMutation();\n  const [registerUser] = useRegisterUserMutation();\n  const dispatch = useTypedDispatch();\n\n  const handleRegisterAdmin = async (\n    { news, ...body }: RegisterAdmin.Request['body'] & { news: boolean },\n    setFormErrors: FormHelpers<RegisterFormValues>['setErrors']\n  ) => {\n    const res = await registerAdmin({ ...body, deviceId: getOrCreateDeviceId() });\n\n    if ('data' in res) {\n      dispatch(login({ token: res.data.token }));\n\n      if (news) {\n        // Only enable EE survey if user accepted the newsletter\n        setNpsSurveySettings((s) => ({ ...s, enabled: true }));\n\n        navigate({\n          pathname: '/usecase',\n          search: `?hasAdmin=${true}`,\n        });\n      } else {\n        navigate('/');\n      }\n    } else {\n      if (isBaseQueryError(res.error)) {\n        trackUsage('didNotCreateFirstAdmin');\n\n        if (res.error.name === 'ValidationError') {\n          setFormErrors(formatValidationErrors(res.error));\n          return;\n        }\n\n        setApiError(formatAPIError(res.error));\n      }\n    }\n  };\n\n  const handleRegisterUser = async (\n    { news, ...body }: RegisterUser.Request['body'] & { news: boolean },\n    setFormErrors: FormHelpers<RegisterFormValues>['setErrors']\n  ) => {\n    const res = await registerUser({ ...body, deviceId: getOrCreateDeviceId() });\n\n    if ('data' in res) {\n      dispatch(login({ token: res.data.token }));\n\n      if (news) {\n        // Only enable EE survey if user accepted the newsletter\n        setNpsSurveySettings((s) => ({ ...s, enabled: true }));\n\n        navigate({\n          pathname: '/usecase',\n          search: `?hasAdmin=${hasAdmin}`,\n        });\n      } else {\n        navigate('/');\n      }\n    } else {\n      if (isBaseQueryError(res.error)) {\n        trackUsage('didNotCreateFirstAdmin');\n\n        if (res.error.name === 'ValidationError') {\n          setFormErrors(formatValidationErrors(res.error));\n          return;\n        }\n\n        setApiError(formatAPIError(res.error));\n      }\n    }\n  };\n\n  if (\n    !match ||\n    (match.params.authType !== 'register' && match.params.authType !== 'register-admin')\n  ) {\n    return <Navigate to=\"/\" />;\n  }\n\n  const isAdminRegistration = match.params.authType === 'register-admin';\n\n  const schema = isAdminRegistration ? REGISTER_ADMIN_SCHEMA : REGISTER_USER_SCHEMA;\n\n  return (\n    <UnauthenticatedLayout>\n      <LayoutContent>\n        <Flex direction=\"column\" alignItems=\"center\" gap={3}>\n          <Logo />\n\n          <Typography tag=\"h1\" variant=\"alpha\" textAlign=\"center\">\n            {formatMessage({\n              id: 'Auth.form.welcome.title',\n              defaultMessage: 'Welcome to Strapi!',\n            })}\n          </Typography>\n          <Typography variant=\"epsilon\" textColor=\"neutral600\" textAlign=\"center\">\n            {formatMessage({\n              id: 'Auth.form.register.subtitle',\n              defaultMessage:\n                'Credentials are only used to authenticate in Strapi. All saved data will be stored in your database.',\n            })}\n          </Typography>\n          {apiError ? (\n            <Typography id=\"global-form-error\" role=\"alert\" tabIndex={-1} textColor=\"danger600\">\n              {apiError}\n            </Typography>\n          ) : null}\n        </Flex>\n        <Form\n          method=\"POST\"\n          initialValues={\n            {\n              firstname: userInfo?.firstname || '',\n              lastname: userInfo?.lastname || '',\n              email: userInfo?.email || '',\n              password: '',\n              confirmPassword: '',\n              registrationToken: registrationToken || undefined,\n              news: false,\n            } satisfies RegisterFormValues\n          }\n          onSubmit={async (data, helpers) => {\n            const normalizedData = normalizeData(data);\n\n            try {\n              await schema.validate(normalizedData, { abortEarly: false });\n\n              if (submitCount > 0 && isAdminRegistration) {\n                trackUsage('didSubmitWithErrorsFirstAdmin', { count: submitCount.toString() });\n              }\n\n              if (normalizedData.registrationToken) {\n                handleRegisterUser(\n                  {\n                    userInfo: omit(normalizedData, [\n                      'registrationToken',\n                      'confirmPassword',\n                      'email',\n                      'news',\n                    ]),\n                    registrationToken: normalizedData.registrationToken,\n                    news: normalizedData.news,\n                  },\n                  helpers.setErrors\n                );\n              } else {\n                await handleRegisterAdmin(\n                  omit(normalizedData, ['registrationToken', 'confirmPassword']),\n                  helpers.setErrors\n                );\n              }\n            } catch (err) {\n              if (err instanceof ValidationError) {\n                const formatDescriptor = (msg: any) => {\n                  try {\n                    if (!msg) return '';\n                    if (typeof msg === 'string') return msg;\n                    // Direct descriptor\n                    if ('id' in msg && 'defaultMessage' in msg) return formatMessage(msg as any);\n                    // Wrapped descriptor: { message: { id, defaultMessage } }\n                    if (msg.message && typeof msg.message === 'object' && 'id' in msg.message) {\n                      return formatMessage(msg.message as any);\n                    }\n                    // errors array: [{ id, defaultMessage }]\n                    if (Array.isArray(msg.errors) && msg.errors.length > 0) {\n                      const first = msg.errors[0];\n                      if (typeof first === 'string') return first;\n                      if (first && typeof first === 'object' && 'id' in first)\n                        return formatMessage(first as any);\n                    }\n                    // fallback to defaultMessage if present\n                    if ('defaultMessage' in msg) return msg.defaultMessage;\n                    return String(msg);\n                  } catch (e) {\n                    return String(msg);\n                  }\n                };\n\n                const computed = err.inner.reduce<Record<string, string>>(\n                  (acc, { message, path }) => {\n                    if (!path) return acc;\n                    acc[path] = formatDescriptor(message);\n                    return acc;\n                  },\n                  {}\n                );\n\n                helpers.setErrors(computed);\n              }\n\n              setSubmitCount(submitCount + 1);\n            }\n          }}\n        >\n          <Flex direction=\"column\" alignItems=\"stretch\" gap={6} marginTop={7}>\n            <Grid.Root gap={4}>\n              {[\n                {\n                  label: formatMessage({\n                    id: 'Auth.form.firstname.label',\n                    defaultMessage: 'Firstname',\n                  }),\n                  name: 'firstname',\n                  required: true,\n                  size: 6,\n                  type: 'string' as const,\n                },\n                {\n                  label: formatMessage({\n                    id: 'Auth.form.lastname.label',\n                    defaultMessage: 'Lastname',\n                  }),\n                  name: 'lastname',\n                  size: 6,\n                  type: 'string' as const,\n                },\n                {\n                  disabled: !isAdminRegistration,\n                  label: formatMessage({\n                    id: 'Auth.form.email.label',\n                    defaultMessage: 'Email',\n                  }),\n                  name: 'email',\n                  required: true,\n                  size: 12,\n                  type: 'email' as const,\n                },\n                {\n                  hint: formatMessage({\n                    id: 'Auth.form.password.hint',\n                    defaultMessage:\n                      'Must be at least 8 characters, 1 uppercase, 1 lowercase & 1 number',\n                  }),\n                  label: formatMessage({\n                    id: 'global.password',\n                    defaultMessage: 'Password',\n                  }),\n                  name: 'password',\n                  required: true,\n                  size: 12,\n                  type: 'password' as const,\n                },\n                {\n                  label: formatMessage({\n                    id: 'Auth.form.confirmPassword.label',\n                    defaultMessage: 'Confirm Password',\n                  }),\n                  name: 'confirmPassword',\n                  required: true,\n                  size: 12,\n                  type: 'password' as const,\n                },\n                {\n                  label: formatMessage(\n                    {\n                      id: 'Auth.form.register.news.label',\n                      defaultMessage:\n                        'Keep me updated about new features & upcoming improvements (by doing this you accept the {terms} and the {policy}).',\n                    },\n                    {\n                      terms: (\n                        <A target=\"_blank\" href=\"https://strapi.io/terms\" rel=\"noreferrer\">\n                          {formatMessage({\n                            id: 'Auth.privacy-policy-agreement.terms',\n                            defaultMessage: 'terms',\n                          })}\n                        </A>\n                      ),\n                      policy: (\n                        <A target=\"_blank\" href=\"https://strapi.io/privacy\" rel=\"noreferrer\">\n                          {formatMessage({\n                            id: 'Auth.privacy-policy-agreement.policy',\n                            defaultMessage: 'policy',\n                          })}\n                        </A>\n                      ),\n                    }\n                  ),\n                  name: 'news',\n                  size: 12,\n                  type: 'checkbox' as const,\n                },\n              ].map(({ size, ...field }) => (\n                <Grid.Item\n                  key={field.name}\n                  xs={12}\n                  m={size}\n                  direction=\"column\"\n                  alignItems=\"stretch\"\n                >\n                  <InputRenderer {...field} />\n                </Grid.Item>\n              ))}\n            </Grid.Root>\n            <Button fullWidth size=\"L\" type=\"submit\">\n              {formatMessage({\n                id: 'Auth.form.button.register',\n                defaultMessage: \"Let's start\",\n              })}\n            </Button>\n          </Flex>\n        </Form>\n        {match?.params.authType === 'register' && (\n          <Box paddingTop={4}>\n            <Flex justifyContent=\"center\">\n              <Link tag={NavLink} to=\"/auth/login\">\n                {formatMessage({\n                  id: 'Auth.link.signin.account',\n                  defaultMessage: 'Already have an account?',\n                })}\n              </Link>\n            </Flex>\n          </Box>\n        )}\n      </LayoutContent>\n    </UnauthenticatedLayout>\n  );\n};\n\ntype StringKeys<T> = {\n  [K in keyof T]: T[K] extends string | undefined ? K : never;\n}[keyof T];\n\n/**\n * @description Trims all values but the password & sets lastName to null if it's a falsey value.\n */\nfunction normalizeData(data: RegisterFormValues) {\n  return Object.entries(data).reduce(\n    (acc, [key, value]) => {\n      type PasswordKeys = Extract<keyof RegisterFormValues, 'password' | 'confirmPassword'>;\n      type RegisterFormStringValues = Exclude<\n        keyof Pick<RegisterFormValues, StringKeys<RegisterFormValues>>,\n        PasswordKeys\n      >;\n\n      if (!['password', 'confirmPassword'].includes(key) && typeof value === 'string') {\n        acc[key as RegisterFormStringValues] = value.trim();\n\n        if (key === 'lastname') {\n          acc[key] = value || undefined;\n        }\n      } else {\n        acc[key as PasswordKeys] = value;\n      }\n\n      return acc;\n    },\n    {} as {\n      firstname: string;\n      lastname: string | undefined;\n      email: string;\n      password: string;\n      confirmPassword: string;\n      registrationToken: string | undefined;\n      news: boolean;\n    }\n  );\n}\n\nconst A = styled.a`\n  color: ${({ theme }) => theme.colors.primary600};\n`;\n\nexport { Register };\nexport type { RegisterProps };\n"],"names":["REGISTER_USER_SCHEMA","yup","object","shape","firstname","string","trim","required","translatedErrors","nullable","lastname","password","min","id","minLength","defaultMessage","values","test","value","byteSize","getByteSize","message","confirmPassword","oneOf","ref","registrationToken","REGISTER_ADMIN_SCHEMA","TextEncoder","encode","length","email","strict","lowercase","Register","hasAdmin","toggleNotification","useNotification","navigate","useNavigate","submitCount","setSubmitCount","React","useState","apiError","setApiError","trackUsage","useTracking","formatMessage","useIntl","search","searchString","useLocation","query","useMemo","URLSearchParams","match","useMatch","_unstableFormatAPIError","formatAPIError","_unstableFormatValidationErrors","formatValidationErrors","useAPIErrorHandler","setNpsSurveySettings","useNpsSurveySettings","get","data","userInfo","error","useGetRegistrationInfoQuery","skip","useEffect","isBaseQueryError","type","encodeURIComponent","registerAdmin","useRegisterAdminMutation","registerUser","useRegisterUserMutation","dispatch","useTypedDispatch","handleRegisterAdmin","news","body","setFormErrors","res","deviceId","getOrCreateDeviceId","login","token","s","enabled","pathname","name","handleRegisterUser","params","authType","_jsx","Navigate","to","isAdminRegistration","schema","UnauthenticatedLayout","_jsxs","LayoutContent","Flex","direction","alignItems","gap","Logo","Typography","tag","variant","textAlign","textColor","role","tabIndex","Form","method","initialValues","undefined","onSubmit","helpers","normalizedData","normalizeData","validate","abortEarly","count","toString","omit","setErrors","err","ValidationError","formatDescriptor","msg","Array","isArray","errors","first","String","e","computed","inner","reduce","acc","path","marginTop","Grid","Root","label","size","disabled","hint","terms","A","target","href","rel","policy","map","field","Item","xs","m","InputRenderer","Button","fullWidth","Box","paddingTop","justifyContent","Link","NavLink","Object","entries","key","includes","styled","a","theme","colors","primary600"],"mappings":"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"}