{
  "version": 3,
  "sources": ["../../../@strapi/upload/admin/src/utils/getTrad.ts", "../../../@strapi/upload/admin/src/enums.ts", "../../../@strapi/upload/admin/src/utils/typeFromMime.ts", "../../../@strapi/upload/admin/src/utils/urlYupSchema.ts", "../../../@strapi/upload/admin/src/constants.ts", "../../../@strapi/upload/admin/src/hooks/useSettings.ts", "../../../@strapi/upload/admin/src/hooks/useTracking.ts"],
  "sourcesContent": ["import { pluginId } from '../pluginId';\n\nexport const getTrad = (id: string) => `${pluginId}.${id}`;\n", "export enum DocType {\n  Pdf = 'pdf',\n  Csv = 'csv',\n  Xls = 'xls',\n  Zip = 'zip',\n}\n\nexport enum AssetType {\n  Video = 'video',\n  Image = 'image',\n  Document = 'doc',\n  Audio = 'audio',\n}\n", "import { AssetType, DocType } from '../enums';\n\nconst MIME_TYPE_MAP: Record<string, AssetType | DocType> = {\n  image: AssetType.Image,\n  video: AssetType.Video,\n  audio: AssetType.Audio,\n  pdf: DocType.Pdf,\n  csv: DocType.Csv,\n  // For XLS files the mime is application/vnd.ms-excel so we need to check for 'excel' not 'xls'\n  excel: DocType.Xls,\n  zip: DocType.Zip,\n};\n\nconst MIME_TYPE_KEYS = Object.keys(MIME_TYPE_MAP) as Array<keyof typeof MIME_TYPE_MAP>;\n\nexport const typeFromMime = (mime: string): AssetType | DocType => {\n  const mimeTypeKey = MIME_TYPE_KEYS.find((m) => mime.toLowerCase().includes(m));\n\n  if (mimeTypeKey === undefined) return AssetType.Document;\n\n  return MIME_TYPE_MAP[mimeTypeKey] ?? AssetType.Document;\n};\n", "import { translatedErrors as errorsTrads } from '@strapi/admin/strapi-admin';\nimport * as yup from 'yup';\n\nimport { getTrad } from './getTrad';\n\nexport const urlSchema = yup.object().shape({\n  urls: yup.string().test({\n    name: 'isUrlValid',\n    // eslint-disable-next-line no-template-curly-in-string\n    message: '${path}',\n    test(values = '') {\n      const urls = values.split(/\\r?\\n/);\n\n      if (urls.length === 0) {\n        return this.createError({\n          path: this.path,\n          message: errorsTrads.min.id,\n        });\n      }\n\n      if (urls.length > 20) {\n        return this.createError({\n          path: this.path,\n          message: errorsTrads.max.id,\n        });\n      }\n\n      const filtered = urls.filter((val) => {\n        try {\n          // eslint-disable-next-line no-new\n          new URL(val);\n\n          return false;\n        } catch (err) {\n          // invalid url\n          return true;\n        }\n      });\n\n      const filteredLength = filtered.length;\n\n      if (filteredLength === 0) {\n        return true;\n      }\n\n      const errorMessage =\n        filteredLength > 1\n          ? 'form.upload-url.error.url.invalids'\n          : 'form.upload-url.error.url.invalid';\n\n      return this.createError({\n        path: this.path,\n        message: getTrad(errorMessage),\n        params: { number: filtered.length },\n      });\n    },\n  }),\n});\n", "import { getTrad } from './utils';\n\nexport enum AssetSource {\n  Url = 'url',\n  Computer = 'computer',\n}\n\nexport const PERMISSIONS = {\n  // This permission regards the main component (App) and is used to tell\n  // If the plugin link should be displayed in the menu\n  // And also if the plugin is accessible. This use case is found when a user types the url of the\n  // plugin directly in the browser\n  main: [\n    { action: 'plugin::upload.read', subject: null },\n    {\n      action: 'plugin::upload.assets.create',\n      subject: null,\n    },\n    {\n      action: 'plugin::upload.assets.update',\n      subject: null,\n    },\n  ],\n  copyLink: [\n    {\n      action: 'plugin::upload.assets.copy-link',\n      subject: null,\n    },\n  ],\n  create: [\n    {\n      action: 'plugin::upload.assets.create',\n      subject: null,\n    },\n  ],\n  download: [\n    {\n      action: 'plugin::upload.assets.download',\n      subject: null,\n    },\n  ],\n  read: [{ action: 'plugin::upload.read', subject: null }],\n  configureView: [{ action: 'plugin::upload.configure-view', subject: null }],\n  settings: [{ action: 'plugin::upload.settings.read', subject: null }],\n  update: [{ action: 'plugin::upload.assets.update', subject: null, fields: null }],\n};\n\nexport const tableHeaders = [\n  {\n    name: 'preview',\n    key: 'preview',\n    metadatas: {\n      label: { id: getTrad('list.table.header.preview'), defaultMessage: 'preview' },\n      isSortable: false,\n    },\n    type: 'image',\n  },\n  {\n    name: 'name',\n    key: 'name',\n    metadatas: {\n      label: { id: getTrad('list.table.header.name'), defaultMessage: 'name' },\n      isSortable: true,\n    },\n    type: 'text',\n  },\n  {\n    name: 'ext',\n    key: 'extension',\n    metadatas: {\n      label: { id: getTrad('list.table.header.ext'), defaultMessage: 'extension' },\n      isSortable: false,\n    },\n    type: 'ext',\n  },\n  {\n    name: 'size',\n    key: 'size',\n    metadatas: {\n      label: { id: getTrad('list.table.header.size'), defaultMessage: 'size' },\n      isSortable: false,\n    },\n    type: 'size',\n  },\n  {\n    name: 'createdAt',\n    key: 'createdAt',\n    metadatas: {\n      label: { id: getTrad('list.table.header.createdAt'), defaultMessage: 'created' },\n      isSortable: true,\n    },\n    type: 'date',\n  },\n  {\n    name: 'updatedAt',\n    key: 'updatedAt',\n    metadatas: {\n      label: { id: getTrad('list.table.header.updatedAt'), defaultMessage: 'last update' },\n      isSortable: true,\n    },\n    type: 'date',\n  },\n];\n\nexport const sortOptions = [\n  { key: 'sort.created_at_desc', value: 'createdAt:DESC' },\n  { key: 'sort.created_at_asc', value: 'createdAt:ASC' },\n  { key: 'sort.name_asc', value: 'name:ASC' },\n  { key: 'sort.name_desc', value: 'name:DESC' },\n  { key: 'sort.updated_at_desc', value: 'updatedAt:DESC' },\n  { key: 'sort.updated_at_asc', value: 'updatedAt:ASC' },\n];\n\nexport const pageSizes = [10, 20, 50, 100];\n\nexport const localStorageKeys = {\n  modalView: `STRAPI_UPLOAD_MODAL_VIEW`,\n  view: `STRAPI_UPLOAD_LIBRARY_VIEW`,\n};\n\nexport const viewOptions = {\n  GRID: 0,\n  LIST: 1,\n};\n", "import { useFetchClient } from '@strapi/admin/strapi-admin';\nimport { useQuery } from 'react-query';\n\nimport type { GetSettings } from '../../../shared/contracts/settings';\n\nexport function useSettings(isEnabled: boolean = true) {\n  const { get } = useFetchClient();\n\n  return useQuery({\n    queryKey: ['upload', 'settings'],\n    enabled: isEnabled,\n    async queryFn() {\n      const {\n        data: { data },\n      } = await get<GetSettings.Response['data']>('/upload/settings');\n\n      return data;\n    },\n  });\n}\n", "import { useTracking as useStrapiTracking, TrackingEvent } from '@strapi/admin/strapi-admin';\nimport { useAIAvailability } from '@strapi/admin/strapi-admin/ee';\n\nimport { useSettings } from '../hooks/useSettings';\n\nexport const useTracking = () => {\n  const { trackUsage: trackStrapiUsage } = useStrapiTracking();\n  const { data } = useSettings();\n  const isAiAvailable = useAIAvailability();\n\n  const trackUsage = <TEvent extends TrackingEvent>(\n    event: TEvent['name'],\n    properties?: TEvent['properties']\n  ) => {\n    return trackStrapiUsage(event, {\n      ...properties,\n      ...(isAiAvailable ? { isAIMediaLibraryConfigured: Boolean(data?.aiMetadata) } : {}),\n    } as TEvent['properties']);\n  };\n\n  return { trackUsage };\n};\n"],
  "mappings": "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",
  "names": ["getTrad", "id", "pluginId", "DocType", "AssetType", "MIME_TYPE_MAP", "image", "AssetType", "Image", "video", "Video", "audio", "Audio", "pdf", "DocType", "Pdf", "csv", "Csv", "excel", "Xls", "zip", "Zip", "MIME_TYPE_KEYS", "Object", "keys", "typeFromMime", "mime", "mimeTypeKey", "find", "m", "toLowerCase", "includes", "undefined", "Document", "urlSchema", "object", "shape", "urls", "string", "test", "name", "message", "values", "split", "length", "createError", "path", "errorsTrads", "min", "id", "max", "filtered", "filter", "val", "URL", "err", "filteredLength", "errorMessage", "getTrad", "params", "number", "AssetSource", "PERMISSIONS", "main", "action", "subject", "copyLink", "create", "download", "read", "configureView", "settings", "update", "fields", "tableHeaders", "name", "key", "metadatas", "label", "id", "getTrad", "defaultMessage", "isSortable", "type", "sortOptions", "value", "pageSizes", "localStorageKeys", "modalView", "view", "viewOptions", "GRID", "LIST", "useSettings", "isEnabled", "get", "useFetchClient", "useQuery", "queryKey", "enabled", "queryFn", "data", "useTracking", "trackUsage", "trackStrapiUsage", "useStrapiTracking", "data", "useSettings", "isAiAvailable", "useAIAvailability", "event", "properties", "isAIMediaLibraryConfigured", "Boolean", "aiMetadata"]
}
