import {
  useControllableState
} from "./chunk-6MMPRXTW.js";
import {
  MemoizedInputRenderer
} from "./chunk-P3KG67LP.js";
import {
  Form
} from "./chunk-BYONMGEP.js";
import {
  useQueryParams
} from "./chunk-XFZS7AGH.js";
import {
  require_lib
} from "./chunk-ESSUPVTG.js";
import {
  createContext
} from "./chunk-KTKIRFL6.js";
import {
  I,
  R,
  T,
  a1,
  c1,
  f0,
  h1,
  l1,
  o1,
  s1,
  useIntl,
  wo,
  yo,
  zn
} from "./chunk-SVMBPSSC.js";
import {
  Link
} from "./chunk-QECYQD6B.js";
import {
  C5,
  j5,
  sn
} from "./chunk-URHUI7CZ.js";
import {
  require_jsx_runtime
} from "./chunk-LMPM4PM5.js";
import {
  require_react
} from "./chunk-D3I3COXH.js";
import {
  __toESM
} from "./chunk-LK32TJAX.js";

// node_modules/@strapi/admin/dist/admin/admin/src/components/Filters.mjs
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
var React = __toESM(require_react(), 1);

// node_modules/@strapi/admin/dist/admin/admin/src/constants/filters.mjs
var BASE_FILTERS = [
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$eq",
      defaultMessage: "is"
    },
    value: "$eq"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$ne",
      defaultMessage: "is not"
    },
    value: "$ne"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$null",
      defaultMessage: "is null"
    },
    value: "$null"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$notNull",
      defaultMessage: "is not null"
    },
    value: "$notNull"
  }
];
var NUMERIC_FILTERS = [
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$gt",
      defaultMessage: "is greater than"
    },
    value: "$gt"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$gte",
      defaultMessage: "is greater than or equal to"
    },
    value: "$gte"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$lt",
      defaultMessage: "is less than"
    },
    value: "$lt"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$lte",
      defaultMessage: "is less than or equal to"
    },
    value: "$lte"
  }
];
var IS_SENSITIVE_FILTERS = [
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$eqi",
      defaultMessage: "is (case insensitive)"
    },
    value: "$eqi"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$nei",
      defaultMessage: "is not (case insensitive)"
    },
    value: "$nei"
  }
];
var CONTAINS_FILTERS = [
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$contains",
      defaultMessage: "contains"
    },
    value: "$contains"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$containsi",
      defaultMessage: "contains (case insensitive)"
    },
    value: "$containsi"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$notContains",
      defaultMessage: "not contains"
    },
    value: "$notContains"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$notContainsi",
      defaultMessage: "not contains (case insensitive)"
    },
    value: "$notContainsi"
  }
];
var STRING_PARSE_FILTERS = [
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$startsWith",
      defaultMessage: "starts with"
    },
    value: "$startsWith"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$startsWithi",
      defaultMessage: "starts with (case insensitive)"
    },
    value: "$startsWithi"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$endsWith",
      defaultMessage: "ends with"
    },
    value: "$endsWith"
  },
  {
    label: {
      id: "components.FilterOptions.FILTER_TYPES.$endsWithi",
      defaultMessage: "ends with (case insensitive)"
    },
    value: "$endsWithi"
  }
];
var FILTERS_WITH_NO_VALUE = [
  "$null",
  "$notNull"
];

// node_modules/@strapi/admin/dist/admin/admin/src/components/Filters.mjs
var [FiltersProvider, useFilters] = createContext("Filters");
var Root = ({ children, disabled = false, onChange, options = [], onOpenChange, open: openProp, defaultOpen, ...restProps }) => {
  const handleChange = (data) => {
    if (onChange) {
      onChange(data);
    }
  };
  const [open = false, setOpen] = useControllableState({
    prop: openProp,
    defaultProp: defaultOpen,
    onChange: onOpenChange
  });
  return (0, import_jsx_runtime.jsx)(c1.Root, {
    open,
    onOpenChange: setOpen,
    ...restProps,
    children: (0, import_jsx_runtime.jsx)(FiltersProvider, {
      setOpen,
      disabled,
      onChange: handleChange,
      options,
      children
    })
  });
};
var Trigger = React.forwardRef(({ label }, forwardedRef) => {
  const { formatMessage } = useIntl();
  const disabled = useFilters("Trigger", ({ disabled: disabled2 }) => disabled2);
  return (0, import_jsx_runtime.jsx)(c1.Trigger, {
    children: (0, import_jsx_runtime.jsx)(zn, {
      variant: "tertiary",
      ref: forwardedRef,
      startIcon: (0, import_jsx_runtime.jsx)(j5, {}),
      size: "S",
      disabled,
      children: label || formatMessage({
        id: "app.utils.filters",
        defaultMessage: "Filters"
      })
    })
  });
});
var PopoverImpl = ({ zIndex }) => {
  var _a;
  const [{ query }, setQuery] = useQueryParams();
  const { formatMessage } = useIntl();
  const options = useFilters("Popover", ({ options: options2 }) => options2);
  const onChange = useFilters("Popover", ({ onChange: onChange2 }) => onChange2);
  const setOpen = useFilters("Popover", ({ setOpen: setOpen2 }) => setOpen2);
  if (options.length === 0) {
    return null;
  }
  const handleSubmit = (data) => {
    var _a2, _b;
    const value = FILTERS_WITH_NO_VALUE.includes(data.filter) ? "true" : encodeURIComponent(data.value ?? "");
    if (!value) {
      return;
    }
    if (onChange) {
      onChange(data);
    }
    const fieldOptions = options.find((filter) => filter.name === data.name);
    const operatorValuePairing = {
      [data.filter]: value
    };
    const newFilterQuery = {
      ...query.filters,
      $and: [
        ...((_a2 = query.filters) == null ? void 0 : _a2.$and) ?? [],
        {
          [data.name]: fieldOptions.type === "relation" ? {
            [((_b = fieldOptions.mainField) == null ? void 0 : _b.name) ?? "id"]: operatorValuePairing
          } : operatorValuePairing
        }
      ]
    };
    setQuery({
      filters: newFilterQuery,
      page: 1
    }, "push", true);
    setOpen(false);
  };
  return (0, import_jsx_runtime.jsx)(c1.Content, {
    style: {
      zIndex
    },
    children: (0, import_jsx_runtime.jsx)(R, {
      padding: 3,
      children: (0, import_jsx_runtime.jsx)(Form, {
        method: "POST",
        initialValues: {
          name: (_a = options[0]) == null ? void 0 : _a.name,
          filter: BASE_FILTERS[0].value
        },
        onSubmit: handleSubmit,
        children: ({ values: formValues, modified, isSubmitting }) => {
          var _a2;
          const filter = options.find((filter2) => filter2.name === formValues.name);
          const Input = (filter == null ? void 0 : filter.input) || MemoizedInputRenderer;
          return (0, import_jsx_runtime.jsxs)(T, {
            direction: "column",
            alignItems: "stretch",
            gap: 2,
            style: {
              minWidth: 184
            },
            children: [
              [
                {
                  ["aria-label"]: formatMessage({
                    id: "app.utils.select-field",
                    defaultMessage: "Select field"
                  }),
                  name: "name",
                  options: options.map((filter2) => ({
                    label: filter2.label,
                    value: filter2.name
                  })),
                  placholder: formatMessage({
                    id: "app.utils.select-field",
                    defaultMessage: "Select field"
                  }),
                  type: "enumeration"
                },
                {
                  ["aria-label"]: formatMessage({
                    id: "app.utils.select-filter",
                    defaultMessage: "Select filter"
                  }),
                  name: "filter",
                  options: (filter == null ? void 0 : filter.operators) || getFilterList(filter).map((opt) => ({
                    label: formatMessage(opt.label),
                    value: opt.value
                  })),
                  placeholder: formatMessage({
                    id: "app.utils.select-filter",
                    defaultMessage: "Select filter"
                  }),
                  type: "enumeration"
                }
              ].map((field) => (0, import_jsx_runtime.jsx)(MemoizedInputRenderer, {
                ...field
              }, field.name)),
              filter && formValues.filter && formValues.filter !== "$null" && formValues.filter !== "$notNull" ? (0, import_jsx_runtime.jsx)(Input, {
                ...filter,
                label: null,
                "aria-label": filter.label,
                name: "value",
                // @ts-expect-error â€“ if type is `custom` then `Input` will be a custom component.
                type: ((_a2 = filter.mainField) == null ? void 0 : _a2.type) ?? filter.type
              }) : null,
              (0, import_jsx_runtime.jsx)(zn, {
                disabled: !modified || isSubmitting,
                size: "L",
                variant: "secondary",
                startIcon: (0, import_jsx_runtime.jsx)(sn, {}),
                type: "submit",
                fullWidth: true,
                children: formatMessage({
                  id: "app.utils.add-filter",
                  defaultMessage: "Add filter"
                })
              })
            ]
          });
        }
      })
    })
  });
};
var getFilterList = (filter) => {
  var _a;
  if (!filter) {
    return [];
  }
  const type = ((_a = filter.mainField) == null ? void 0 : _a.type) ? filter.mainField.type : filter.type;
  switch (type) {
    case "email":
    case "text":
    case "string": {
      return [
        ...BASE_FILTERS,
        ...IS_SENSITIVE_FILTERS,
        ...CONTAINS_FILTERS,
        ...STRING_PARSE_FILTERS
      ];
    }
    case "float":
    case "integer":
    case "biginteger":
    case "decimal": {
      return [
        ...BASE_FILTERS,
        ...NUMERIC_FILTERS
      ];
    }
    case "time":
    case "date": {
      return [
        ...BASE_FILTERS,
        ...NUMERIC_FILTERS,
        ...CONTAINS_FILTERS
      ];
    }
    case "datetime": {
      return [
        ...BASE_FILTERS,
        ...NUMERIC_FILTERS
      ];
    }
    case "enumeration": {
      return BASE_FILTERS;
    }
    default:
      return [
        ...BASE_FILTERS,
        ...IS_SENSITIVE_FILTERS
      ];
  }
};
var List = () => {
  var _a, _b, _c, _d;
  const [{ query }, setQuery] = useQueryParams();
  const options = useFilters("List", ({ options: options2 }) => options2);
  const handleClick = (data) => {
    var _a2;
    const nextFilters = (((_a2 = query == null ? void 0 : query.filters) == null ? void 0 : _a2.$and) ?? []).filter((filter) => {
      const [attributeName] = Object.keys(filter);
      if (attributeName !== data.name) {
        return true;
      }
      const { type, mainField } = options.find(({ name }) => name === attributeName);
      if (type === "relation") {
        const filterObj = filter[attributeName][(mainField == null ? void 0 : mainField.name) ?? "id"];
        if (typeof filterObj === "object") {
          const [operator] = Object.keys(filterObj);
          const value = filterObj[operator];
          return !(operator === data.filter && value === data.value);
        }
        return true;
      } else {
        const filterObj = filter[attributeName];
        const [operator] = Object.keys(filterObj);
        const value = filterObj[operator];
        return !(operator === data.filter && value === data.value);
      }
    });
    setQuery({
      filters: {
        $and: nextFilters
      },
      page: 1
    });
  };
  if (!((_b = (_a = query == null ? void 0 : query.filters) == null ? void 0 : _a.$and) == null ? void 0 : _b.length)) {
    return null;
  }
  return (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {
    children: (_d = (_c = query == null ? void 0 : query.filters) == null ? void 0 : _c.$and) == null ? void 0 : _d.map((queryFilter) => {
      var _a2;
      const [attributeName] = Object.keys(queryFilter);
      const filter = options.find(({ name }) => name === attributeName);
      const filterObj = queryFilter[attributeName];
      if (!filter || typeof filterObj !== "object" || filterObj === null) {
        return null;
      }
      if (filter.type === "relation") {
        const modelFilter = filterObj[((_a2 = filter.mainField) == null ? void 0 : _a2.name) ?? "id"];
        if (typeof modelFilter === "object") {
          const [operator] = Object.keys(modelFilter);
          const value = modelFilter[operator];
          return (0, import_jsx_runtime.jsx)(AttributeTag, {
            ...filter,
            onClick: handleClick,
            operator,
            value
          }, `${attributeName}-${operator}-${value}`);
        }
        return null;
      } else {
        const [operator] = Object.keys(filterObj);
        const value = filterObj[operator];
        if (typeof value === "object") {
          return null;
        }
        return (0, import_jsx_runtime.jsx)(AttributeTag, {
          ...filter,
          onClick: handleClick,
          operator,
          value
        }, `${attributeName}-${operator}-${value}`);
      }
    })
  });
};
var AttributeTag = ({ input, label, mainField, name, onClick, operator, options, value, ...filter }) => {
  const { formatMessage, formatDate, formatTime, formatNumber } = useIntl();
  const handleClick = () => {
    onClick({
      name,
      value,
      filter: operator
    });
  };
  const type = (mainField == null ? void 0 : mainField.type) ? mainField.type : filter.type;
  let formattedValue = value;
  switch (type) {
    case "date":
      formattedValue = formatDate(value, {
        dateStyle: "full"
      });
      break;
    case "datetime":
      formattedValue = formatDate(value, {
        dateStyle: "full",
        timeStyle: "short"
      });
      break;
    case "time":
      const [hour, minute] = value.split(":");
      const date = /* @__PURE__ */ new Date();
      date.setHours(Number(hour));
      date.setMinutes(Number(minute));
      formattedValue = formatTime(date, {
        hour: "numeric",
        minute: "numeric"
      });
      break;
    case "float":
    case "integer":
    case "biginteger":
    case "decimal":
      formattedValue = formatNumber(Number(value));
      break;
  }
  if (input && options) {
    const selectedOption = options.find((option) => {
      return (typeof option === "string" ? option : option.value) === value;
    });
    formattedValue = selectedOption ? typeof selectedOption === "string" ? selectedOption : selectedOption.label ?? selectedOption.value : value;
  }
  const content = `${label} ${formatMessage({
    id: `components.FilterOptions.FILTER_TYPES.${operator}`,
    defaultMessage: operator
  })} ${operator !== "$null" && operator !== "$notNull" ? formattedValue : ""}`;
  return (0, import_jsx_runtime.jsx)(f0, {
    padding: 1,
    onClick: handleClick,
    icon: (0, import_jsx_runtime.jsx)(C5, {}),
    children: content
  });
};
var Filters = {
  List,
  Popover: PopoverImpl,
  Root,
  Trigger
};

// node_modules/@strapi/admin/dist/admin/admin/src/components/Pagination.mjs
var import_jsx_runtime2 = __toESM(require_jsx_runtime(), 1);
var React2 = __toESM(require_react(), 1);
var import_qs = __toESM(require_lib(), 1);
var [PaginationProvider, usePagination] = createContext("Pagination");
var Root2 = React2.forwardRef(({ children, defaultPageSize = 10, pageCount = 0, defaultPage = 1, onPageSizeChange, total = 0 }, forwardedRef) => {
  const [{ query }, setQuery] = useQueryParams({
    pageSize: defaultPageSize.toString(),
    page: defaultPage.toString()
  });
  const setPageSize = (pageSize) => {
    setQuery({
      pageSize,
      page: "1"
    });
    if (onPageSizeChange) {
      onPageSizeChange(pageSize);
    }
  };
  return (0, import_jsx_runtime2.jsx)(T, {
    ref: forwardedRef,
    paddingTop: 4,
    paddingBottom: 4,
    alignItems: "flex-end",
    justifyContent: "space-between",
    children: (0, import_jsx_runtime2.jsx)(PaginationProvider, {
      currentQuery: query,
      page: query.page,
      pageSize: query.pageSize,
      pageCount: pageCount.toString(),
      setPageSize,
      total,
      children
    })
  });
});
var PageSize = ({ options = [
  "10",
  "20",
  "50",
  "100"
] }) => {
  const { formatMessage } = useIntl();
  const pageSize = usePagination("PageSize", (state) => state.pageSize);
  const totalCount = usePagination("PageSize", (state) => state.total);
  const setPageSize = usePagination("PageSize", (state) => state.setPageSize);
  const handleChange = (value) => {
    setPageSize(value);
  };
  const minimumOption = parseInt(options[0], 10);
  if (minimumOption >= totalCount) {
    return null;
  }
  return (0, import_jsx_runtime2.jsxs)(T, {
    gap: 2,
    children: [
      (0, import_jsx_runtime2.jsx)(yo, {
        size: "S",
        "aria-label": formatMessage({
          id: "components.PageFooter.select",
          defaultMessage: "Entries per page"
        }),
        // @ts-expect-error from the DS V2 this won't be needed because we're only returning strings.
        onChange: handleChange,
        value: pageSize,
        children: options.map((option) => (0, import_jsx_runtime2.jsx)(wo, {
          value: option,
          children: option
        }, option))
      }),
      (0, import_jsx_runtime2.jsx)(I, {
        textColor: "neutral600",
        tag: "span",
        children: formatMessage({
          id: "components.PageFooter.select",
          defaultMessage: "Entries per page"
        })
      })
    ]
  });
};
var Links = ({ boundaryCount = 1, siblingCount = 1 }) => {
  const { formatMessage } = useIntl();
  const query = usePagination("Links", (state) => state.currentQuery);
  const currentPage = usePagination("Links", (state) => state.page);
  const totalPages = usePagination("Links", (state) => state.pageCount);
  const pageCount = parseInt(totalPages, 10);
  const activePage = parseInt(currentPage, 10);
  const range = (start, end) => {
    const length = end - start + 1;
    return Array.from({
      length
    }, (_, i) => start + i);
  };
  const startPages = range(1, Math.min(boundaryCount, pageCount));
  const endPages = range(Math.max(pageCount - boundaryCount + 1, boundaryCount + 1), pageCount);
  const siblingsStart = Math.max(
    Math.min(
      // Natural start
      activePage - siblingCount,
      // Lower boundary when page is high
      pageCount - boundaryCount - siblingCount * 2 - 1
    ),
    // Greater than startPages
    boundaryCount + 2
  );
  const siblingsEnd = Math.min(
    Math.max(
      // Natural end
      activePage + siblingCount,
      // Upper boundary when page is low
      boundaryCount + siblingCount * 2 + 2
    ),
    // Less than endPages
    endPages.length > 0 ? endPages[0] - 2 : pageCount - 1
  );
  const items = [
    ...startPages,
    // Start ellipsis
    // eslint-disable-next-line no-nested-ternary
    ...siblingsStart > boundaryCount + 2 ? [
      "start-ellipsis"
    ] : boundaryCount + 1 < pageCount - boundaryCount ? [
      boundaryCount + 1
    ] : [],
    // Sibling pages
    ...range(siblingsStart, siblingsEnd),
    // End ellipsis
    // eslint-disable-next-line no-nested-ternary
    ...siblingsEnd < pageCount - boundaryCount - 1 ? [
      "end-ellipsis"
    ] : pageCount - boundaryCount > boundaryCount ? [
      pageCount - boundaryCount
    ] : [],
    ...endPages
  ];
  if (pageCount <= 1) {
    return null;
  }
  return (0, import_jsx_runtime2.jsxs)(o1, {
    activePage,
    pageCount,
    children: [
      (0, import_jsx_runtime2.jsx)(s1, {
        tag: Link,
        to: {
          search: (0, import_qs.stringify)({
            ...query,
            page: activePage - 1
          })
        },
        children: formatMessage({
          id: "components.pagination.go-to-previous",
          defaultMessage: "Go to previous page"
        })
      }),
      items.map((item) => {
        if (typeof item === "number") {
          return (0, import_jsx_runtime2.jsx)(a1, {
            tag: Link,
            number: item,
            to: {
              search: (0, import_qs.stringify)({
                ...query,
                page: item
              })
            },
            children: formatMessage({
              id: "components.pagination.go-to",
              defaultMessage: "Go to page {page}"
            }, {
              page: item
            })
          }, item);
        }
        return (0, import_jsx_runtime2.jsx)(h1, {}, item);
      }),
      (0, import_jsx_runtime2.jsx)(l1, {
        tag: Link,
        to: {
          search: (0, import_qs.stringify)({
            ...query,
            page: activePage + 1
          })
        },
        children: formatMessage({
          id: "components.pagination.go-to-next",
          defaultMessage: "Go to next page"
        })
      })
    ]
  });
};
var Pagination = {
  Root: Root2,
  Links,
  PageSize
};

export {
  Filters,
  Pagination
};
//# sourceMappingURL=chunk-6A3IARPD.js.map
